---
import Layout from "../layouts/Layout.astro";
import Link from "../../components/Elements/Atomic/Link.astro"; // componente importato da....
import Shr from "../../components/Elements/Atomic/Separator.astro";
import About from "../../components/PageSpecific/About.astro";
import Carousel from "../../components/PageSpecific/MainCarousel.astro";
import Projects from "../../components/PageSpecific/Projects.astro";
import FutureProject from "../../components/PageSpecific/FutureProject.astro";
import OurMusic from "../../components/PageSpecific/OurMusic.astro";
import { Image } from "astro:assets";

const images = import.meta.glob('../../assets/images/*.{jpeg,jpg,png}', { eager: true });
const priorityList = [
	"fotoGruppo.jpeg",           // Sarà la prima
	"fotoDavantiMadonnina.jpeg", // Sarà la seconda
	"sfilataViaRoma.jpeg",       // Sarà la terza
	// Aggiungi qui altre foto se vuoi...
];
const galleryImages = Object.entries(images)
	.map(([path, module]: any) => {
		// Estraiamo il nome del file completo (es. "fotoGruppo.jpeg")
		const filenameWithExt = path.split('/').pop();
		// Estraiamo il nome senza estensione per l'alt (es. "fotoGruppo")
		const filenameNoExt = filenameWithExt.split('.')[0];

		return {
			data: module.default,
			alt: filenameNoExt,
			fileName: filenameWithExt // Ci serve per ordinare
		};
	})
	.sort((a, b) => {
		// Cerchiamo l'indice dei file nella nostra lista prioritaria
		const indexA = priorityList.indexOf(a.fileName);
		const indexB = priorityList.indexOf(b.fileName);

		// LOGICA DI ORDINAMENTO:
		// Se entrambi sono nella lista prioritaria, rispetta l'ordine della lista
		if (indexA !== -1 && indexB !== -1) return indexA - indexB;

		// Se solo A è nella lista, A vince (va prima)
		if (indexA !== -1) return -1;

		// Se solo B è nella lista, B vince
		if (indexB !== -1) return 1;

		// Se nessuno dei due è nella lista, ordina alfabeticamente
		return a.fileName.localeCompare(b.fileName);
	});
---
<Layout title = "SA Scapitzada" language = "it">

	<About/>
	<Shr topSpace="20px" bottomSpace="20px"/>
	<Carousel height="300px">
		{
			galleryImages.map((image) => (
				<div >
					<Image
						src={image.data}
						alt={image.alt}
					/>
				</div>
			))
		}
	</Carousel>
	<Shr topSpace="20px" bottomSpace="20px"/>
	<Projects/>
	<Shr topSpace="20px" bottomSpace="20px"/>
	<FutureProject/>
	<Shr topSpace="20px" bottomSpace="20px"/>
	<OurMusic/>
</Layout>